<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì£¼ì°¨ ì°¨ëŸ‰ í™•ì¸ê¸° (ì•ˆì •í™” ë²„ì „)</title>
<style>
  body { font-family: -apple-system, system-ui, "Noto Sans KR", sans-serif; background:#f7f7fb; text-align:center; padding:20px; }
  h2 { color:#2b4eff; margin-bottom:8px; }
  input { font-size:1.15em; padding:10px; width:200px; margin:10px; border-radius:10px; border:1px solid #ccc; text-align:center; }
  button { font-size:1.05em; padding:10px 18px; border:none; border-radius:10px; background:#2b4eff; color:#fff; margin:4px; }
  button:active { background:#203ad4; }
  #stopBtn { background:#ff5c5c; display:none; }
  table { margin:20px auto; border-collapse:collapse; width:92%; background:#fff; box-shadow:0 2px 8px rgba(0,0,0,.08); }
  th, td { border:1px solid #e9ecf1; padding:10px; }
  th { background:#f1f3f6; }
  #status { margin-top:12px; font-weight:600; color:#333; }
  #hint { margin-top:6px; color:#555; font-size:.95em; }
</style>
</head>
<body>
  <h2>ğŸ¤ ì£¼ì°¨ ì°¨ëŸ‰ í™•ì¸ê¸°</h2>
  <input id="carInput" placeholder="4ìë¦¬ ë²ˆí˜¸ ì…ë ¥" inputmode="numeric" />
  <button id="searchBtn">ì¡°íšŒ</button>
  <button id="voiceBtn">ğŸ™ï¸ ìŒì„±ìœ¼ë¡œ ì¡°íšŒ ì‹œì‘</button>
  <button id="stopBtn">â–  ì¤‘ì§€</button>

  <div id="status"></div>
  <div id="hint">Chrome(ì•ˆë“œë¡œì´ë“œ) ê¶Œì¥. iOS SafariëŠ” ìŒì„±ì¸ì‹ ì§€ì›ì´ ì œí•œì ì…ë‹ˆë‹¤.</div>

  <table id="resultTable" style="display:none;">
    <thead>
      <tr><th>ë²ˆí˜¸</th><th>ìƒ‰ìƒ</th><th>ì°¨ì¢…</th><th>ì£¼ì°¨ìŠ¤í‹°ì»¤</th></tr>
    </thead>
    <tbody></tbody>
  </table>

<script>
/* ===== ì°¨ëŸ‰ ë°ì´í„°(ì˜ˆì‹œ) ===== */
const carData = [
  { ë²ˆí˜¸: "0114", ì£¼ì°¨ìŠ¤í‹°ì»¤: "ìˆìŒ(í™©ìƒ‰)", ìƒ‰ìƒ: "í°ìƒ‰",   ì°¨ì¢…: "ë ˆì´" },
  { ë²ˆí˜¸: "0136", ì£¼ì°¨ìŠ¤í‹°ì»¤: "ìˆìŒ(í™©ìƒ‰)", ìƒ‰ìƒ: "í°ìƒ‰",   ì°¨ì¢…: "C36 ì•„ìš°ë””" },
  { ë²ˆí˜¸: "0159", ì£¼ì°¨ìŠ¤í‹°ì»¤: "ìˆìŒ(í™©ìƒ‰)", ìƒ‰ìƒ: "ë² ì´ì§€", ì°¨ì¢…: "ëª¨ë‹" },
  { ë²ˆí˜¸: "0211", ì£¼ì°¨ìŠ¤í‹°ì»¤: "ì—†ìŒ",       ìƒ‰ìƒ: "ê²€ì •ê³„ì—´", ì°¨ì¢…: "í¬ë£¨ì¦ˆ" },
  { ë²ˆí˜¸: "0227", ì£¼ì°¨ìŠ¤í‹°ì»¤: "ìˆìŒ(í™©ìƒ‰)", ìƒ‰ìƒ: "í°ìƒ‰",   ì°¨ì¢…: "K7" },
  { ë²ˆí˜¸: "0759", ì£¼ì°¨ìŠ¤í‹°ì»¤: "ìˆìŒ(í™©ìƒ‰)", ìƒ‰ìƒ: "ì²­ìƒ‰ê³„ì—´", ì°¨ì¢…: "ì†Œë‚˜íƒ€" },
  { ë²ˆí˜¸: "0841", ì£¼ì°¨ìŠ¤í‹°ì»¤: "ìˆìŒ(í™©ìƒ‰)", ìƒ‰ìƒ: "í°ìƒ‰",   ì°¨ì¢…: "ì•„ì´ì˜¤ë‹‰" },
  { ë²ˆí˜¸: "1045", ì£¼ì°¨ìŠ¤í‹°ì»¤: "ìˆìŒ(í™©ìƒ‰)", ìƒ‰ìƒ: "ê²€ì •ê³„ì—´", ì°¨ì¢…: "G90" }
];

/* ===== UI ì—˜ë¦¬ë¨¼íŠ¸ ===== */
const inputEl   = document.getElementById("carInput");
const statusEl  = document.getElementById("status");
const table     = document.getElementById("resultTable");
const tbody     = table.querySelector("tbody");
const voiceBtn  = document.getElementById("voiceBtn");
const stopBtn   = document.getElementById("stopBtn");
const searchBtn = document.getElementById("searchBtn");

/* ===== ì „ì—­ ìƒíƒœ ===== */
let recognition = null;
let listening = false;
let sessionEndsAt = 0; // 30ë¶„ ì„¸ì…˜ ì¢…ë£Œ ì‹œê°(ms)
let restarting = false;

/* ===== ìœ í‹¸ ===== */
function speak(text) {
  if (!("speechSynthesis" in window)) return;
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "ko-KR";
  window.speechSynthesis.cancel(); // ê²¹ì¹¨ ë°©ì§€
  window.speechSynthesis.speak(u);
}

function showResult(row) {
  tbody.innerHTML = `<tr>
    <td>${row.ë²ˆí˜¸}</td>
    <td>${row.ìƒ‰ìƒ}</td>
    <td>${row.ì°¨ì¢…}</td>
    <td>${row.ì£¼ì°¨ìŠ¤í‹°ì»¤}</td>
  </tr>`;
  table.style.display = "table";
  statusEl.textContent = "âœ… ì°¨ëŸ‰ ì •ë³´ê°€ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.";
}

function checkCar() {
  const digits = (inputEl.value || "").replace(/\D/g, "");
  if (!digits) {
    statusEl.textContent = "â„¹ï¸ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ ë§ì”€í•´ì£¼ì„¸ìš”.";
    speak("ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ ë§ì”€í•´ì£¼ì„¸ìš”.");
    table.style.display = "none";
    return;
  }
  const num = digits.slice(-4).padStart(Math.min(4, digits.length), "0"); // ë¹ˆê°’ì´ë©´ pad ì•ˆ í•¨
  const found = carData.find(c => c.ë²ˆí˜¸ === num);
  if (found) {
    showResult(found);
    speak(`${num}ë²ˆ ì°¨ëŸ‰ì€ ${found.ìƒ‰ìƒ} ${found.ì°¨ì¢…}, ì£¼ì°¨ìŠ¤í‹°ì»¤ ${found.ì£¼ì°¨ìŠ¤í‹°ì»¤} ì…ë‹ˆë‹¤.`);
  } else {
    table.style.display = "none";
    statusEl.textContent = `ğŸš« ${num}ë²ˆ ì°¨ëŸ‰ì€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`;
    speak(`${num}ë²ˆ ì°¨ëŸ‰ì€ ë“±ë¡ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.`);
  }
}

/* ===== ìŒì„± ì¸ì‹ ===== */
function ensureRecognition() {
  if (!("webkitSpeechRecognition" in window)) {
    alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„±ì¸ì‹ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Chrome(ì•ˆë“œë¡œì´ë“œ) ê¶Œì¥.");
    return false;
  }
  if (!recognition) {
    recognition = new webkitSpeechRecognition();
    recognition.lang = "ko-KR";
    recognition.continuous = true;
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    recognition.onstart = () => {
      listening = true;
      statusEl.textContent = "ğŸ¤ ë“£ëŠ” ì¤‘ â€” ë²ˆí˜¸ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”â€¦";
      voiceBtn.style.display = "none";
      stopBtn.style.displa

